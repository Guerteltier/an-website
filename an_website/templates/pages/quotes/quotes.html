{% whitespace oneline %}
{% extends "../../base.html" %}

{% block body %}
<div id="quote-container">
    <div id="top">
        <a href="{{fix_url(f'/zitate/info/z/{wrong_quote.quote.id}')}}"
           class="no-style-a quote-text"
           id="quote">»{{wrong_quote.quote}}«</a>
        <a href="{{fix_url(f'/zitate/info/a/{wrong_quote.author.id}')}}"
           class="no-style-a quote-author"
           id="author">- {{wrong_quote.author}}</a>
    </div>
    <div id="rating-container">
        <table>
            <tr>
                <th>
                    <div id="rating-text">{{rating}}</div>
                </th>
                <th id="rating-img-container">
                {% if int(wrong_quote.rating) == 0 or rating in ("???", "---") %}
                    <img class="rating-img invisible" src="" alt=""/>
                {% else %}
                    {% for i in range(min(4, abs(int(wrong_quote.rating)))) %}
                        {% if int(wrong_quote.rating) < 0 %}
                    <div class="rating-img nicht-witzig"></div>
                        {% elif int(wrong_quote.rating) > 0 %}
                    <div class="rating-img witzig"></div>
                        {% end %}
                    {% end %}
                {% end %}
                </th>
            </tr>
        </table>
    </div>
    <div id="buttons">
        <a class="download tooltip" id="download"
           href="{{fix_url(f'/zitate/{wrong_quote.get_id_as_str()}/image.png')}}"
           download="zitat-{{ wrong_quote.get_id_as_str() }}.png"
        >
            <img class="download-img button-img" src="/static/img/arrow.svg" alt="Zitat downloaden.">
            <div class="tooltip-text">Downloade das Zitat als Bild.</div>
        </a>
        <a class="share tooltip" id="share"
           href="{{fix_url(f'/zitate/{wrong_quote.get_id_as_str()}/share/')}}"
        >
            <img class="share-img button-img" src="/static/img/arrow.svg" alt="Zitat teilen.">
            <div class="tooltip-text">Teile das Zitat auf Social Media.</div>
        </a>
        <a class="get-quote tooltip" id="next" href="{{next_href}}">
            <img class="get-quote-img button-img button-img-no-rotation" alt="Nächstes Zitat" src="/static/img/arrow.svg">
            <div class="tooltip-text">Gehe zum nächsten Zitat.</div>
        </a>
    </div>
</div>
<form method="post" id="vote-container">
    {% raw form_appendix %}
    <input name="r" class="hidden-input" value="{{rating_filter}}">
    <button type="submit" id="upvote" name="vote"
            class="form-button vote {% if vote == 1 %} voted {% end %}"
            value={% if vote == 1 %}"0"{% else %}"1"{% end %} >
        <img src="/static/img/StempelWitzigKlein.svg" alt="WITZIG!">
    </button>
    <button type="submit" id="downvote" name="vote"
            class="form-button vote {% if vote == -1 %} voted {% end %}"
            value={% if vote == -1 %}"0"{% else %}"-1"{% end %} >
        <img src="/static/img/StempelNichtWitzigKlein.svg" alt="NICHT WITZIG!">
    </button>
</form>

<div id="bottom-buttons-container">
    <a class="tooltip" href="{{fix_url('/zitate/erstellen/')}}">
        <img class="button-img button-img-no-rotation"
             src="/static/img/plus.svg" alt="Zitat hinzufügen.">
        <div class="tooltip-text">Füge neues Zitat hinzu.</div>
    </a>

    {% if settings.get("CONTACT_EMAIL") is not None %}
        <a class="report tooltip"
           href="mailto:{{settings['CONTACT_EMAIL']}}?subject=Das falsche Zitat mit der Id {{wrong_quote.get_id_as_str()}} hat ein Problem&body={{str(wrong_quote) + '\n'}}"
        >
            <img class="button-img report-img button-img-no-rotation"
                 alt="Zitat melden."
                 src="/static/img/report.svg">
            <div class="tooltip-text">Melde das Zitat.</div>
        </a>
    {% end %}

    <form method="get">
        {% raw form_appendix %}
        <select name="r" class="rating-form-el" onchange="this.form.submit()">
            <option value="smart" {% if rating_filter=="smart"%}selected{%end%}>Smart</option>
            <option value="w" {% if rating_filter=="w"%}selected{%end%}>Witzig</option>
            <option value="n" {% if rating_filter=="n"%}selected{%end%}>Nicht witzig</option>
            <option value="rated" {% if rating_filter=="rated"%}selected{%end%}>Bewertet</option>
            <option value="unrated" {% if rating_filter=="unrated"%}selected{%end%}>Unbewertet</option>
            <option value="all" {% if rating_filter=="all"%}selected{%end%}>Alle</option>
        </select>
        <noscript>
            <button type="submit" class="rating-form-el">Submit</button>
        </noscript>
    </form>
</div>

<script>
    const thisQuoteId = ["{{wrong_quote.get_id_as_str()}}"];
    const nextQuoteId = ["{{next_id}}"];
</script>
<script src="/static/js/quote.js"></script>
{% end %}

{% block head %}
<!--<meta property="og:image"
          content="{{fix_url(f'/zitate/{wrong_quote.get_id_as_str()}/image.png')}}">
-->
    <link rel="stylesheet" type="text/css" href="/static/style/form.css">
    <link rel="stylesheet" type="text/css" href="/static/style/quote.css">
{% end %}
